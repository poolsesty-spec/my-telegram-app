<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Eluma Elite</title>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

    <style>
        :root {
            --accent: #FF7F50;
            /* Sunset Orange */
            --salad: #bef264;
            /* Soft Salad Green */

            /* Light Mode Default */
            --bg: #FDFCF8;
            --text-primary: #1A1A1A;
            --text-secondary: #666666;
            --surface: rgba(255, 255, 255, 0.65);
            --surface-border: rgba(255, 255, 255, 0.8);
            --input-bg: rgba(255, 255, 255, 0.5);
            --shadow-color: rgba(0, 0, 0, 0.05);
            --orb-opacity: 0.6;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0F0F11;
                --text-primary: #F2F2F2;
                --text-secondary: #AAAAAA;
                --surface: rgba(30, 30, 32, 0.60);
                --surface-border: rgba(255, 255, 255, 0.1);
                --input-bg: rgba(255, 255, 255, 0.05);
                --shadow-color: rgba(0, 0, 0, 0.3);
                --orb-opacity: 0.3;
            }
        }

        body {
            font-family: 'Manrope', sans-serif;
            background-color: var(--bg);
            color: var(--text-primary);
            margin: 0;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            min-height: 100vh;
        }

        /* Abstract Background Orbs */
        #background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            overflow: hidden;
            pointer-events: none;
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(90px);
            opacity: var(--orb-opacity);
        }

        .orb-1 {
            width: 300px;
            height: 300px;
            background: #FFDAB9;
            top: -50px;
            left: -50px;
        }

        .orb-2 {
            width: 400px;
            height: 400px;
            background: #FFE4E1;
            bottom: -100px;
            right: -100px;
        }

        .orb-3 {
            width: 250px;
            height: 250px;
            background: rgba(190, 242, 100, 0.3);
            /* Salad hint */
            top: 40%;
            left: 30%;
        }

        .grain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            opacity: 0.04;
        }

        .plex {
            background: var(--surface);
            backdrop-filter: blur(35px) saturate(140%);
            -webkit-backdrop-filter: blur(35px) saturate(140%);
            border: 1px solid var(--surface-border);
            border-radius: 28px;
            box-shadow: 0 15px 35px -10px var(--shadow-color);
        }

        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 16px 20px;
            /* Added gentle blur backdrop for header when scrolling over content */
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            margin-bottom: 0;
        }

        .btn-primary {
            background: linear-gradient(135deg, #FF7F50, #FF6347);
            color: white;
            box-shadow: 0 10px 20px -5px rgba(255, 99, 71, 0.4);
            transition: transform 0.2s, background 0.3s;
        }

        .btn-primary:active {
            transform: scale(0.97);
        }

        .btn-execute {
            background: rgba(255, 127, 80, 0.15);
            /* Soft Orange */
            color: var(--accent);
            box-shadow: 0 0 15px rgba(255, 127, 80, 0.3);
            border: none;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        /* Active/Completed state: Salad Green "Done" */
        .btn-done {
            background: var(--salad);
            color: #3f6212;
            box-shadow: 0 0 20px rgba(190, 242, 100, 0.6);
            pointer-events: none;
            border: none;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        /* Neon Progress & Checkmarks */
        #mainProgress {
            box-shadow: 0 0 10px var(--accent), 0 0 20px var(--accent);
        }

        .huge-check {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-10deg);
            width: 80%;
            height: 80%;
            opacity: 0.1;
            pointer-events: none;
            filter: blur(1px);
            z-index: 0;
            color: var(--salad);
        }

        .hidden {
            display: none !important;
        }

        input {
            outline: none;
            border: none;
            background: transparent;
            color: var(--text-primary);
            font-family: inherit;
        }

        input::placeholder {
            color: var(--text-secondary);
            opacity: 0.5;
        }

        /* Chart Animation */
        .chart-path {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: dash 2.5s ease-out forwards;
        }

        @keyframes dash {
            to {
                stroke-dashoffset: 0;
            }
        }
    </style>
</head>

<body>

    <div id="background">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>
    <div class="grain"></div>

    <div id="app" class="relative z-10 max-w-md mx-auto h-full flex flex-col min-h-screen">

        <!-- SETUP -->
        <div id="setupScreen" class="p-6 flex-1 flex flex-col justify-center hidden">
            <div class="plex p-8 text-center">
                <h1 class="text-4xl font-extrabold mb-8 tracking-tight text-[var(--accent)]">ELUMA</h1>
                <div
                    class="bg-[var(--input-bg)] border border-[var(--surface-border)] p-4 rounded-[24px] mb-6 text-center shadow-sm">
                    <input id="goalInput" type="text" placeholder="Главная цель..."
                        class="w-full text-center font-bold text-lg">
                </div>
                <div id="tasksInputs" class="space-y-3 mb-10 text-left"></div>
                <button onclick="saveSettings()"
                    class="w-full py-5 rounded-[24px] btn-primary font-bold text-lg uppercase tracking-wide">Активировать</button>
            </div>
        </div>

        <!-- MAIN -->
        <div id="mainScreen" class="flex-1 flex flex-col hidden">
            <div class="sticky-header cursor-pointer active:scale-[0.99] transition-transform" onclick="goToCabinet()">
                <div class="plex p-3 pr-5 flex items-center gap-4">
                    <img id="userAvatar" src="https://via.placeholder.com/100"
                        class="w-12 h-12 rounded-full border-2 border-[var(--surface-border)] object-cover shadow-sm">
                    <div class="flex-1 overflow-hidden">
                        <div class="flex justify-between items-center mb-1">
                            <p
                                class="text-[10px] font-bold uppercase tracking-wider text-[var(--text-secondary)] text-left">
                                Главная цель</p>
                            <div
                                class="flex items-center gap-1 bg-[var(--input-bg)] px-2 py-0.5 rounded-full border border-[var(--surface-border)]">
                                <span
                                    class="text-[9px] font-bold uppercase tracking-wider text-[var(--salad)]">Фокус</span>
                                <span id="pointsHeader" class="text-[10px] font-black text-[var(--text-primary)]">0
                                    XP</span>
                            </div>
                        </div>
                        <h2 id="displayGoal"
                            class="text-base font-bold text-[var(--text-primary)] truncate mb-2 text-left">...</h2>
                        <div class="w-full h-1.5 bg-[var(--input-bg)] rounded-full overflow-hidden">
                            <div id="mainProgress"
                                class="h-full bg-[var(--accent)] transition-all duration-1000 rounded-full"
                                style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="p-5 pt-0 flex-1 flex flex-col">
                <!-- Days Chart Card -->
                <div class="plex p-0 mb-6 relative overflow-hidden h-[120px] flex items-end">
                    <div class="absolute top-4 left-5 z-10">
                        <span
                            class="text-[10px] font-bold uppercase tracking-wider text-[var(--text-secondary)] block mb-0.5">Дни
                            в потоке</span>
                        <span id="daysText"
                            class="text-4xl font-extrabold text-[var(--text-primary)] leading-none">0</span>
                    </div>

                    <!-- Decorative Chart SVG -->
                    <svg class="w-full h-[80%] opacity-80" viewBox="0 0 300 100" preserveAspectRatio="none">
                        <defs>
                            <linearGradient id="saladGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:var(--salad);stop-opacity:0.4" />
                                <stop offset="100%" style="stop-color:var(--salad);stop-opacity:0" />
                            </linearGradient>
                        </defs>
                        <path d="M0,100 L0,70 Q30,60 60,80 T120,50 T180,60 T240,20 L300,10 L300,100 Z"
                            fill="url(#saladGradient)" />
                        <path class="chart-path" d="M0,70 Q30,60 60,80 T120,50 T180,60 T240,20 L300,10" fill="none"
                            stroke="var(--salad)" stroke-width="3" stroke-linecap="round" />
                    </svg>
                </div>

                <div id="tasksGrid" class="grid grid-cols-2 gap-4 mb-8 text-left flex-1 content-start"></div>

                <div class="flex justify-center pb-10">
                    <button onclick="goToSettings(event)"
                        class="plex w-14 h-14 rounded-full flex items-center justify-center active:scale-90 transition-transform bg-[var(--surface)] text-[var(--text-secondary)] hover:text-[var(--text-primary)]">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" />
                        </svg>
                    </button>
                </div>

                <div
                    class="text-center pb-8 opacity-30 text-[9px] tracking-[3px] uppercase font-bold text-[var(--text-secondary)]">
                    System Build: v.2.2.0
                </div>
            </div>
        </div>
    </div>

    <!-- CABINET SCREEN -->
    <div id="cabinetScreen" class="hidden text-left flex-1 flex flex-col min-h-screen bg-[var(--bg)] justify-start">
        <!-- Header (Cloned for Cabinet) -->
        <div class="plex m-5 mb-2 p-3 pr-5 flex items-center gap-4 relative">
            <button onclick="backToMainFromCabinet()"
                class="absolute -top-2 -right-2 text-[10px] plex w-8 h-8 flex items-center justify-center rounded-full font-bold text-[var(--text-secondary)] bg-[var(--surface)] shadow-md z-20">
                ✕
            </button>
            <img id="cabUserAvatar" src="https://via.placeholder.com/100"
                class="w-12 h-12 rounded-full border-2 border-[var(--surface-border)] object-cover shadow-sm">
            <div class="flex-1 overflow-hidden">
                <div class="flex justify-between items-center mb-1">
                    <p class="text-[10px] font-bold uppercase tracking-wider text-[var(--text-secondary)] text-left">
                        Главная цель</p>
                    <div
                        class="flex items-center gap-1 bg-[var(--input-bg)] px-2 py-0.5 rounded-full border border-[var(--surface-border)]">
                        <span class="text-[9px] font-bold uppercase tracking-wider text-[var(--salad)]">Фокус</span>
                        <span id="cabPointsHeader" class="text-[10px] font-black text-[var(--text-primary)]">0 XP</span>
                    </div>
                </div>
                <h2 id="cabDisplayGoal" class="text-base font-bold text-[var(--text-primary)] truncate mb-2 text-left">
                    ...</h2>
                <div class="w-full h-1.5 bg-[var(--input-bg)] rounded-full overflow-hidden">
                    <div id="cabMainProgress"
                        class="h-full bg-[var(--accent)] transition-all duration-1000 rounded-full box-shadow-[0_0_10px_var(--accent)]"
                        style="width: 0%"></div>
                </div>
            </div>
        </div>

        <div class="space-y-4 flex-1 overflow-y-auto p-5 pt-0">

            <!-- Activity Chart -->
            <div class="plex p-0 relative overflow-hidden h-[140px] flex items-end">
                <div class="absolute top-4 left-5 z-10">
                    <span
                        class="text-[10px] font-bold uppercase tracking-wider text-[var(--text-secondary)] block mb-0.5">Активность</span>
                    <div class="flex items-baseline gap-2">
                        <span id="cabDaysTextChart"
                            class="text-4xl font-extrabold text-[var(--text-primary)] leading-none">0</span>
                    </div>
                </div>

                <!-- Chart SVG -->
                <svg class="w-full h-[70%] opacity-90" viewBox="0 0 300 100" preserveAspectRatio="none">
                    <defs>
                        <linearGradient id="saladGradient2" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:var(--salad);stop-opacity:0.6" />
                            <stop offset="100%" style="stop-color:var(--salad);stop-opacity:0" />
                        </linearGradient>
                    </defs>
                    <path d="M0,100 L0,60 Q30,50 60,70 T120,40 T180,50 T240,10 L300,5 L300,100 Z"
                        fill="url(#saladGradient2)" />
                    <path class="chart-path" d="M0,60 Q30,50 60,70 T120,40 T180,50 T240,10 L300,5" fill="none"
                        stroke="var(--salad)" stroke-width="3" stroke-linecap="round" />
                </svg>
            </div>

            <!-- Motivation Text -->
            <div class="plex p-6">
                <p class="text-[13px] font-bold text-[var(--text-secondary)] uppercase tracking-wider mb-2 opacity-70">
                    Мотивация</p>
                <p class="text-[14px] leading-relaxed font-medium text-[var(--text-primary)] opacity-90">
                    Нажимай «Готово» и чувствуй радость приближения цели. Твой мозг запоминает это ощущение и создаёт
                    ассоциацию: действие приносит радость. Когда настанет время следующего шага, тебе будет проще
                    начать, подсознание уже знает, что впереди награда. Так работает твоя внутренняя система мотивации.
                    Ты программируешь себя на достижение целей каждым нажатием кнопки.
                </p>
            </div>


            <div
                class="px-4 py-8 text-center opacity-30 text-[9px] tracking-[3px] uppercase font-bold text-[var(--text-secondary)]">
                Eluma Elite v.2.4.0
            </div>
        </div>
    </div>

    <!-- SETTINGS -->
    <div id="editScreen" class="p-6 hidden text-left flex-1 flex flex-col">
        <div class="flex items-center justify-between mb-8 pt-4">
            <h2 class="text-2xl font-bold text-[var(--text-primary)]">Настройки</h2>
            <button onclick="backToMain()"
                class="text-xs plex px-5 py-3 rounded-[18px] font-bold text-[var(--text-secondary)] bg-[var(--surface)]">Закрыть</button>
        </div>
        <div class="space-y-6 flex-1">
            <div class="plex p-6 text-left">
                <label
                    class="text-[10px] font-bold text-[var(--text-secondary)] uppercase mb-3 block tracking-wider">Редактировать
                    цель</label>
                <input id="editGoalInput" type="text"
                    class="w-full border-b-2 border-[var(--surface-border)] focus:border-[var(--accent)] transition-colors p-2 font-bold text-lg text-[var(--text-primary)]">
            </div>
            <div class="plex p-6 text-left">
                <label
                    class="text-[10px] font-bold text-[var(--text-secondary)] uppercase mb-5 block tracking-wider">Ваши
                    шаги</label>
                <div id="editTasksInputs" class="space-y-4"></div>
            </div>
        </div>
        <button onclick="updateSettings()"
            class="w-full py-5 rounded-[24px] btn-primary font-bold text-lg uppercase tracking-wide mt-6 mb-8">Сохранить</button>
    </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // Dynamic Theme Handling
        function updateTheme() {
            const isDark = (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
            if (tg) {
                tg.setHeaderColor(isDark ? '#0F0F11' : '#FDFCF8');
                tg.setBackgroundColor(isDark ? '#0F0F11' : '#FDFCF8');
            }
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', updateTheme);
        updateTheme();

        if (tg.initDataUnsafe?.user?.photo_url) {
            document.getElementById('userAvatar').src = tg.initDataUnsafe.user.photo_url;
            document.getElementById('cabUserAvatar').src = tg.initDataUnsafe.user.photo_url;
        }

        let state = {
            goal: localStorage.getItem('el_goal') || '',
            tasks: JSON.parse(localStorage.getItem('el_tasks')) || [],
            completed: JSON.parse(localStorage.getItem('el_completed_today')) || [],
            rewardedSlots: JSON.parse(localStorage.getItem('el_rewarded_today')) || [],
            points: parseInt(localStorage.getItem('el_points')) || 0,
            days: parseInt(localStorage.getItem('el_days')) || 0,
            lastDate: localStorage.getItem('el_last_date') || '',
            bonusClaimedDate: localStorage.getItem('el_bonus_date') || '',
            dayIncrementedDate: localStorage.getItem('el_day_inc_date') || ''
        };

        function getElumaDate() {
            let now = new Date();
            now.setHours(now.getHours() - 3);
            return now.toDateString();
        }

        function saveState() {
            localStorage.setItem('el_goal', state.goal);
            localStorage.setItem('el_tasks', JSON.stringify(state.tasks));
            localStorage.setItem('el_completed_today', JSON.stringify(state.completed));
            localStorage.setItem('el_rewarded_today', JSON.stringify(state.rewardedSlots));
            localStorage.setItem('el_points', state.points);
            localStorage.setItem('el_days', state.days);
            localStorage.setItem('el_last_date', state.lastDate);
            localStorage.setItem('el_bonus_date', state.bonusClaimedDate);
            localStorage.setItem('el_day_inc_date', state.dayIncrementedDate);
        }

        const tIn = document.getElementById('tasksInputs');
        const eIn = document.getElementById('editTasksInputs');
        tIn.innerHTML = ''; eIn.innerHTML = '';
        for (let i = 0; i < 6; i++) {
            tIn.innerHTML += `<div class="bg-[var(--input-bg)] border border-[var(--surface-border)] p-4 rounded-[20px] shadow-sm"><input type="text" placeholder="Шаг ${i + 1}" class="t-in w-full text-[var(--text-primary)] font-medium text-sm"></div>`;
            eIn.innerHTML += `<div class="bg-[var(--input-bg)] border border-[var(--surface-border)] p-3 rounded-[16px]"><input type="text" class="e-in w-full text-[var(--text-primary)] font-medium text-sm bg-transparent"></div>`;
        }

        function init() {
            const today = getElumaDate();
            if (state.lastDate !== today) {
                state.completed = [];
                state.rewardedSlots = [];
                state.lastDate = today;
                saveState();
            }

            document.getElementById('setupScreen').classList.add('hidden');
            document.getElementById('mainScreen').classList.add('hidden');
            document.getElementById('editScreen').classList.add('hidden');
            document.getElementById('cabinetScreen').classList.add('hidden');

            if (!state.goal) {
                document.getElementById('setupScreen').classList.remove('hidden');
            } else {
                document.getElementById('mainScreen').classList.remove('hidden');
                render();
            }
        }

        function toggleTask(idx) {
            if (state.completed.includes(idx)) return;
            const today = getElumaDate();

            state.completed.push(idx);

            // Logic: Award point only if this slot hasn't been rewarded today
            if (!state.rewardedSlots.includes(idx)) {
                state.points += 1;
                state.rewardedSlots.push(idx);
            }

            // Logic: Bonus (Total 12 max implied: 6 tasks + 6 bonus = 12)
            if (state.completed.length === 6 && state.bonusClaimedDate !== today) {
                state.points += 6; state.days += 1;
                state.bonusClaimedDate = today;
            }

            // Logic: Day increment on FIRST task
            if (state.completed.length >= 1 && state.dayIncrementedDate !== today) {
                state.days += 1;
                state.dayIncrementedDate = today;
            }
            saveState();
            render();
            tg.HapticFeedback.impactOccurred('medium');
            setTimeout(() => tg.HapticFeedback.impactOccurred('light'), 100);
        }

        function render() {
            // Main Screen Update
            document.getElementById('displayGoal').innerText = state.goal;
            document.getElementById('pointsHeader').innerText = state.points + ' XP';
            document.getElementById('daysText').innerText = state.days;
            document.getElementById('mainProgress').style.width = (state.completed.length / 6 * 100) + '%';

            // Cabinet Screen Update (Sync)
            document.getElementById('cabDisplayGoal').innerText = state.goal;
            document.getElementById('cabPointsHeader').innerText = state.points + ' XP';
            document.getElementById('cabMainProgress').style.width = (state.completed.length / 6 * 100) + '%';
            document.getElementById('cabDaysTextChart').innerText = state.days;

            const grid = document.getElementById('tasksGrid');
            grid.innerHTML = '';
            state.tasks.forEach((t, i) => {
                const isDone = state.completed.includes(i);
                grid.innerHTML += `
                    <div class="plex p-5 flex flex-col justify-between items-center text-center min-h-[140px] active:scale-95 transition-all cursor-pointer relative overflow-hidden group" onclick="toggleTask(${i})">
                        ${isDone ? '<div class="absolute inset-0 bg-[#bef264]/10 z-0"></div><svg class="huge-check" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 13L9 17L19 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>' : ''}
                        <p class="text-[13px] font-semibold leading-snug mb-3 flex-1 flex items-center justify-center text-[var(--text-primary)] z-10">${t}</p>
                        <div class="w-full py-3 rounded-[16px] text-[10px] font-extrabold uppercase tracking-wider z-10 transition-all ${isDone ? 'btn-done' : 'btn-execute'}">
                            ГОТОВО
                        </div>
                    </div>
                `;
            });
        }

        function saveSettings() {
            const g = document.getElementById('goalInput').value.trim();
            const t = Array.from(document.querySelectorAll('.t-in')).map(i => i.value.trim()).filter(v => v !== '');
            if (g && t.length === 6) {
                state.goal = g;
                state.tasks = t;
                state.lastDate = getElumaDate();
                saveState();
                init();
            }
        }

        function updateSettings() {
            const nGoal = document.getElementById('editGoalInput').value.trim();
            const nTasks = Array.from(document.querySelectorAll('.e-in')).map(i => i.value.trim()).filter(v => v !== '');
            if (nGoal && nTasks.length === 6) {
                nTasks.forEach((task, i) => {
                    if (task !== state.tasks[i]) {
                        // Logic: Changing task removes "done" state, but logic above prevents RE-AWARDING points for this slot if already rewarded.
                        const idx = state.completed.indexOf(i);
                        if (idx !== -1) state.completed.splice(idx, 1);
                    }
                });
                state.goal = nGoal;
                state.tasks = nTasks;
                saveState();
                backToMain();
            }
        }

        function goToSettings(e) {
            e.stopPropagation(); // Prevent bubbling to header click
            window.scrollTo(0, 0);
            document.getElementById('mainScreen').classList.add('hidden');
            document.getElementById('editScreen').classList.remove('hidden');
            document.getElementById('editGoalInput').value = state.goal;
            const inputs = document.querySelectorAll('.e-in');
            state.tasks.forEach((t, i) => inputs[i].value = t);
        }

        function goToCabinet() {
            window.scrollTo(0, 0);
            document.getElementById('mainScreen').classList.add('hidden');
            document.getElementById('cabinetScreen').classList.remove('hidden');
        }

        function backToMainFromCabinet() {
            window.scrollTo(0, 0);
            document.getElementById('cabinetScreen').classList.add('hidden');
            document.getElementById('mainScreen').classList.remove('hidden');
            render();
        }

        function backToMain() {
            window.scrollTo(0, 0);
            document.getElementById('editScreen').classList.add('hidden');
            document.getElementById('mainScreen').classList.remove('hidden');
            render();
        }

        // Parallax Effect
        window.addEventListener('scroll', () => {
            const scrollPos = window.pageYOffset;
            const bg = document.getElementById('background');
            bg.style.transform = `translate3d(0, ${scrollPos * -0.05}px, 0)`;
        });

        init();
    </script>
</body>

</html>
