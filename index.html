<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Eluma - Discipline Alpha</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800;900&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #a3e635; --teal: #2dd4bf; --bg: #0d0f12; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: white;
            margin: 0;
            overflow-x: hidden;
            overflow-y: auto;
            min-height: 100vh;
            -webkit-tap-highlight-color: transparent;
        }

        .bg-wrapper {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background: radial-gradient(circle at 50% 50%, #15181d 0%, #080a0c 100%);
        }
        .cloud {
            position: absolute; filter: blur(70px); border-radius: 50%; opacity: 0.3;
            animation: move 25s infinite alternate ease-in-out;
        }
        .cloud-1 { width: 300px; height: 300px; background: var(--teal); top: -20px; left: -50px; }
        .cloud-2 { width: 350px; height: 350px; background: var(--accent); bottom: -50px; right: -50px; }
        @keyframes move { 0% { transform: translate(0,0) scale(1); } 100% { transform: translate(40px, 60px) scale(1.15); } }

        .plex {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px) saturate(160%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 28px;
        }

        .btn-done {
            background: rgba(163, 230, 53, 0.05);
            border: 1px solid rgba(163, 230, 53, 0.2);
            color: var(--accent);
            transition: all 0.3s;
        }
        .btn-locked {
            background: var(--accent);
            color: #000;
            box-shadow: 0 0 15px rgba(163, 230, 53, 0.4);
            border: none;
            pointer-events: none;
        }

        .screen { width: 100%; padding: 20px; display: flex; flex-direction: column; }
        .hidden { display: none !important; }

        .avatar-glow {
            box-shadow: 0 0 20px rgba(163, 230, 53, 0.2);
            border: 2px solid rgba(163, 230, 53, 0.4);
        }
    </style>
</head>
<body>

    <div class="bg-wrapper"><div class="cloud cloud-1"></div><div class="cloud cloud-2"></div></div>

    <div id="app" class="relative w-full">
        
        <!-- –≠–ö–†–ê–ù 1: –ü–ï–†–í–ò–ß–ù–ê–Ø –ù–ê–°–¢–†–û–ô–ö–ê -->
        <div id="setupScreen" class="screen min-h-screen flex items-center justify-center hidden">
            <div class="plex w-full max-w-sm p-8 text-center">
                <h1 class="text-3xl font-black italic tracking-tighter mb-8">ELUMA</h1>
                <input id="goalInput" type="text" placeholder="–¢–≤–æ—è —Ü–µ–ª—å..." class="w-full bg-black/40 border border-white/10 p-4 rounded-2xl mb-4 outline-none focus:border-lime-400 text-white">
                <div id="tasksInputs" class="space-y-2 mb-6 text-left">
                    <label class="text-[10px] font-bold text-lime-400 uppercase ml-2">6 —Å—Ç–æ–ª–ø–æ–≤ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã</label>
                </div>
                <button onclick="saveSettings()" class="w-full py-4 rounded-2xl bg-lime-400 text-black font-black uppercase tracking-widest">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù 2: –î–ê–®–ë–û–†–î -->
        <div id="mainScreen" class="screen">
            <!-- –¶–µ–ª—å –∏ –ê–≤–∞—Ç–∞—Ä -->
            <div class="plex p-5 mb-6 mt-2 flex items-center gap-4">
                <div class="relative">
                    <img src="https://i.ibb.co/L9H8S7p/avatar-energy.jpg" class="w-16 h-16 rounded-full avatar-glow object-cover">
                    <div id="onlineStatus" class="absolute bottom-0 right-0 w-4 h-4 bg-lime-500 border-2 border-[#0d0f12] rounded-full"></div>
                </div>
                <div class="flex-1">
                    <p class="text-[9px] font-bold uppercase tracking-[2px] text-lime-400 opacity-70">–¢–µ–∫—É—â–∞—è —Ü–µ–ª—å</p>
                    <h2 id="displayGoal" class="text-xl font-black uppercase tracking-tight leading-tight">...</h2>
                    <div class="w-full h-1 bg-white/5 rounded-full mt-3 overflow-hidden">
                        <div id="mainProgress" class="h-full bg-gradient-to-r from-teal-400 to-lime-400 transition-all duration-1000" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="px-2 mb-6">
                <div class="flex justify-between items-end mb-4">
                    <div>
                        <p class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-1">–ù–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –æ–ø—ã—Ç</p>
                        <p class="text-2xl font-black text-white" id="pointsText">0 –ë–ê–õ–õ–û–í</p>
                    </div>
                    <div class="text-right">
                        <p class="text-[10px] font-bold text-lime-400 uppercase tracking-widest mb-1">–î–Ω–µ–π –Ω–∞ –ø—É—Ç–∏ –∫ —Ü–µ–ª–∏</p>
                        <p class="text-2xl font-black text-white" id="daysText">0</p>
                    </div>
                </div>
            </div>

            <!-- –°–µ—Ç–∫–∞ –∑–∞–¥–∞—á -->
            <div id="tasksGrid" class="grid grid-cols-2 gap-3 mb-8"></div>

            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è (–¢—Ä–∏ —Ç–æ—á–∫–∏) -->
            <div class="flex justify-center pb-12">
                <button onclick="goToSettings()" class="plex w-14 h-8 flex items-center justify-center gap-1 hover:bg-white/10 active:scale-90 transition-all">
                    <div class="w-1 h-1 bg-white/40 rounded-full"></div>
                    <div class="w-1.5 h-1.5 bg-lime-400 rounded-full shadow-[0_0_5px_#a3e635]"></div>
                    <div class="w-1 h-1 bg-white/40 rounded-full"></div>
                </button>
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù 3: –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï (SETTINGS) -->
        <div id="editScreen" class="screen hidden">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-2xl font-black uppercase italic">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <button onclick="backToMain()" class="text-xs font-bold text-lime-400 uppercase tracking-widest px-4 py-2 plex">–ù–∞–∑–∞–¥</button>
            </div>
            
            <div class="space-y-6">
                <div class="plex p-6">
                    <label class="text-[10px] font-bold text-gray-400 uppercase mb-3 block">–ò–∑–º–µ–Ω–∏—Ç—å —Ü–µ–ª—å</label>
                    <input id="editGoalInput" type="text" class="w-full bg-black/30 border border-white/10 p-4 rounded-xl outline-none focus:border-lime-500">
                </div>
                
                <div class="plex p-6">
                    <label class="text-[10px] font-bold text-gray-400 uppercase mb-4 block">–ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∑–∞–¥–∞—á–∏</label>
                    <div id="editTasksInputs" class="space-y-3"></div>
                </div>

                <button onclick="updateSettings()" class="w-full py-5 rounded-2xl bg-lime-400 text-black font-black uppercase tracking-widest shadow-xl">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button onclick="fullReset()" class="w-full py-3 text-[10px] font-bold text-red-500 uppercase tracking-widest opacity-50">–ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</button>
            </div>
        </div>

    </div>

    <script>
        const icons = ["‚òÄÔ∏è", "üßò", "üìö", "üí™", "üìµ", "üìã"];
        
        // --- –°–û–°–¢–û–Ø–ù–ò–ï (LOCAL STORAGE) ---
        let state = {
            goal: localStorage.getItem('el_goal') || '',
            tasks: JSON.parse(localStorage.getItem('el_tasks')) || [],
            completed: JSON.parse(localStorage.getItem('el_completed_today')) || [],
            points: parseInt(localStorage.getItem('el_points')) || 0,
            days: parseInt(localStorage.getItem('el_days')) || 0,
            lastDate: localStorage.getItem('el_last_date') || '' 
        };

        // --- –õ–û–ì–ò–ö–ê –í–†–ï–ú–ï–ù–ò (–°–±—Ä–æ—Å –≤ 3:00) ---
        function getElumaDate() {
            let now = new Date();
            // –°–¥–≤–∏–≥–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ 3 —á–∞—Å–∞ –Ω–∞–∑–∞–¥. –ï—Å–ª–∏ —Å–µ–π—á–∞—Å 2:00 –Ω–æ—á–∏ 25-–≥–æ —á–∏—Å–ª–∞, 
            // —Ç–æ –ø–æ "Eluma-–≤—Ä–µ–º–µ–Ω–∏" —ç—Ç–æ –µ—â–µ 23:00 24-–≥–æ —á–∏—Å–ª–∞.
            now.setHours(now.getHours() - 3);
            return now.toDateString();
        }

        function checkDailyReset() {
            const today = getElumaDate();
            if (state.lastDate !== today) {
                state.completed = [];
                state.lastDate = today;
                saveState();
            }
        }

        function saveState() {
            localStorage.setItem('el_goal', state.goal);
            localStorage.setItem('el_tasks', JSON.stringify(state.tasks));
            localStorage.setItem('el_completed_today', JSON.stringify(state.completed));
            localStorage.setItem('el_points', state.points);
            localStorage.setItem('el_days', state.days);
            localStorage.setItem('el_last_date', state.lastDate);
        }

        // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–û–õ–ï–ô ---
        const tIn = document.getElementById('tasksInputs');
        const eIn = document.getElementById('editTasksInputs');
        for (let i = 0; i < 6; i++) {
            tIn.innerHTML += `<input type="text" placeholder="–®–∞–≥ ${i+1}" class="t-in w-full bg-black/30 border border-white/5 p-3 rounded-xl text-sm outline-none">`;
            eIn.innerHTML += `<input type="text" class="e-in w-full bg-black/30 border border-white/10 p-3 rounded-xl text-sm outline-none focus:border-lime-500">`;
        }

        function init() {
            checkDailyReset();
            if (!state.goal) {
                document.getElementById('setupScreen').classList.remove('hidden');
                document.getElementById('mainScreen').classList.add('hidden');
            } else {
                document.getElementById('setupScreen').classList.add('hidden');
                document.getElementById('mainScreen').classList.remove('hidden');
                render();
            }
        }

        // --- –î–ï–ô–°–¢–í–ò–Ø ---
        function saveSettings() {
            const g = document.getElementById('goalInput').value;
            const t = Array.from(document.querySelectorAll('.t-in')).map(i => i.value).filter(v => v !== '');
            if (g && t.length === 6) {
                state.goal = g; state.tasks = t;
                state.lastDate = getElumaDate();
                saveState(); init();
            } else alert("–ó–∞–ø–æ–ª–Ω–∏ –≤—Å—ë!");
        }

        function updateSettings() {
            const g = document.getElementById('editGoalInput').value;
            const t = Array.from(document.querySelectorAll('.e-in')).map(i => i.value).filter(v => v !== '');
            if (g && t.length === 6) {
                state.goal = g; state.tasks = t;
                saveState(); backToMain();
            }
        }

        function toggleTask(idx) {
            if (state.completed.includes(idx)) return; // –ù–µ–ª—å–∑—è –æ—Ç–∂–∞—Ç—å

            state.completed.push(idx);
            state.points += 1; // 1 –±–∞–ª–ª –∑–∞ –∑–∞–¥–∞—á—É

            if (state.completed.length === 6) {
                state.points += 6; // –ë–æ–Ω—É—Å +6 –∑–∞ –ø–æ–ª–Ω—ã–π –¥–µ–Ω—å
                state.days += 1;   // +1 –¥–µ–Ω—å –∫ –ø—É—Ç–∏
            }
            
            saveState();
            render();
        }

        function render() {
            document.getElementById('displayGoal').innerText = state.goal;
            document.getElementById('pointsText').innerText = state.points + " –ë–ê–õ–õ–û–í";
            document.getElementById('daysText').innerText = state.days;
            
            const grid = document.getElementById('tasksGrid');
            grid.innerHTML = '';

            state.tasks.forEach((t, i) => {
                const isDone = state.completed.includes(i);
                grid.innerHTML += `
                    <div class="plex p-4 flex flex-col justify-between min-h-[120px]" onclick="toggleTask(${i})">
                        <div>
                            <div class="w-8 h-8 bg-black/40 rounded-lg flex items-center justify-center text-sm mb-3 border border-white/5">${icons[i]}</div>
                            <p class="text-[11px] font-bold leading-tight h-8 overflow-hidden">${t}</p>
                        </div>
                        <div class="btn-done py-2.5 rounded-xl text-center text-[9px] font-black uppercase ${isDone ? 'btn-locked' : ''}">
                            ${isDone ? '–ó–∞–≤–µ—Ä—à–µ–Ω–æ ‚úì' : '–í—ã–ø–æ–ª–Ω–∏—Ç—å'}
                        </div>
                    </div>
                `;
            });

            const progress = (state.completed.length / 6) * 100;
            document.getElementById('mainProgress').style.width = progress + '%';
        }

        // --- –ù–ê–í–ò–ì–ê–¶–ò–Ø ---
        function goToSettings() {
            document.getElementById('mainScreen').classList.add('hidden');
            document.getElementById('editScreen').classList.remove('hidden');
            document.getElementById('editGoalInput').value = state.goal;
            const inputs = document.querySelectorAll('.e-in');
            state.tasks.forEach((t, i) => inputs[i].value = t);
        }

        function backToMain() {
            document.getElementById('editScreen').classList.add('hidden');
            document.getElementById('mainScreen').classList.remove('hidden');
            render();
        }

        function fullReset() {
            if(confirm('–≠—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç —Ç–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å (–æ—á–∫–∏ –∏ –¥–Ω–∏). –£–≤–µ—Ä–µ–Ω?')) {
                localStorage.clear();
                location.reload();
            }
        }

        init();
    </script>
</body>
</html>
