<script>
    let tg = window.Telegram.WebApp;
    tg.expand();

    // Загружаем данные из памяти телефона
    let savedGoal = localStorage.getItem('userGoal');
    let savedTasks = JSON.parse(localStorage.getItem('userTasks')) || [];

    const setupSection = document.getElementById('setup-section'); // Создайте этот div в HTML для ввода
    const dashboardSection = document.getElementById('dashboard-section'); // А этот для самого дашборда

    function render() {
        if (!savedGoal) {
            // Показываем форму ввода, если цели нет
            document.body.innerHTML = `
                <div style="padding: 20px; text-align: center; font-family: sans-serif;">
                    <h2>Настройка Eluma</h2>
                    <input id="goalInput" type="text" placeholder="Твоя главная цель" style="width: 80%; padding: 10px; margin-bottom: 10px;">
                    <textarea id="tasksInput" placeholder="5 задач (каждая с новой строки)" style="width: 80%; height: 100px; padding: 10px;"></textarea>
                    <button onclick="saveData()" style="background: #a8e6cf; border: none; padding: 15px 30px; border-radius: 20px; margin-top: 20px;">Начать путь</button>
                </div>
            `;
        } else {
            // Тут ваш обычный код отрисовки дашборда, который вы видели на макете
            // Используйте savedGoal и savedTasks для заполнения полей
        }
    }

    window.saveData = function() {
        const goal = document.getElementById('goalInput').value;
        const tasksText = document.getElementById('tasksInput').value;
        const tasks = tasksText.split('\n').filter(t => t.trim() !== "").map(t => ({name: t, done: false}));

        if (goal && tasks.length > 0) {
            localStorage.setItem('userGoal', goal);
            localStorage.setItem('userTasks', JSON.stringify(tasks));
            location.reload(); // Перезагружаем, чтобы показать дашборд
        } else {
            alert("Заполни цель и хотя бы одну задачу!");
        }
    };

    render();
</script>
